---
title: "Active Directory: Windows Client Setup"
date: 2024-12-21 00:00:00 -0800
categories: [Cybersecurity Lab, Initial Setup]
tags: [cybersecurity, homelab]
description: Setting up a Windows 10 Active Directory client.
---

### ISO Download & VM Setup

The Windows 10 Enterprise ISO can be found at: [https://www.microsoft.com/en-us/evalcenter/download-windows-10-enterprise](https://www.microsoft.com/en-us/evalcenter/download-windows-11-enterprise)

I was having issues trying to set up the Windows 11 Enterprise ISO. Morevoer, Windows 11 requires more RAM and CPU and I am going to be running multiple client VMs, so I just went with Windows 10 to preserve system usage.

> Only Pro, Education, and Enterprise editions of Windows 10/11 can be joined to a domain. Active Directory is not supported in Home Editions. [https://learn.microsoft.com/en-us/answers/questions/1805776/how-to-join-the-active-directory-on-a-regular-comp](https://learn.microsoft.com/en-us/answers/questions/1805776/how-to-join-the-active-directory-on-a-regular-comp)
{: .prompt-warning }

I gave this VM:

2 GB RAM

2 CPUs RAM

50GB Storage

Skip unattended install: checked

>If your VM keeps freezing or getting black screens, you may want to increase the RAM.
{: .prompt-info }

![1](/assets/img/cyberlab/setup/ad_client/1.png){: width="700" height="400" }

Attach adapter 1 to the cyberlab-ad network

![2](/assets/img/cyberlab/setup/ad_client/2.png){: width="500" height="300" }

Launch the VM

Click install now

![3](/assets/img/cyberlab/setup/ad_client/3.png){: width="600" height="400" }

Accept the license

![4](/assets/img/cyberlab/setup/ad_client/4.png){: width="600" height="400" }

Select Custom Install

![5](/assets/img/cyberlab/setup/ad_client/5.png){: width="600" height="400" }

Select Drive 0

Next

![6](/assets/img/cyberlab/setup/ad_client/6.png){: width="600" height="400" }

Wait for the installation to finish (~10 minutes)

![7](/assets/img/cyberlab/setup/ad_client/7.png){: width="600" height="400" }

You may see this screen when the installation finishes

Stop the VM

![8](/assets/img/cyberlab/setup/ad_client/8.png){: width="600" height="400" }

Remember to change the boot order (**Right click the VM from VirtualBox > Settings > System > Motherboard**)

The VM should boot from the hard disk

![9](/assets/img/cyberlab/setup/ad_client/9.png){: width="600" height="400" }

Reboot the VM

![10](/assets/img/cyberlab/setup/ad_client/10.png){: width="600" height="400" }

Select your region

![12](/assets/img/cyberlab/setup/ad_client/11.png){: width="600" height="400" }

Select your keyboard layout

![12](/assets/img/cyberlab/setup/ad_client/12.png){: width="600" height="400" }

Click Continue with limited setup

![13](/assets/img/cyberlab/setup/ad_client/13.png){: width="600" height="400" }

You can put any name; we are not going to use this account, we are going to use the AD users we created from the previous section

![14](/assets/img/cyberlab/setup/ad_client/14.png){: width="600" height="400" }

Just skim through these

![15](/assets/img/cyberlab/setup/ad_client/15.png){: width="600" height="400" }

Uncheck everything and accept

![16](/assets/img/cyberlab/setup/ad_client/16.png){: width="600" height="400" }

Click not now

![17](/assets/img/cyberlab/setup/ad_client/17.png){: width="600" height="400" }

K

![18](/assets/img/cyberlab/setup/ad_client/18.png){: width="600" height="400" }

### IP Configuration

Once Windows boots up, log in as the temporary user

Right click on the internet icon on the bottom right of the screen

Open **Network and Internet Settings > Change Adapter Options**

Right click **Ethernet > Properties > Double Click IPv4 Properties**

I gave this VM the IP 10.10.2.10/24

Set the preferred DNS to 10.10.1.10 (Domain Controller)

and the alternate DNS to 10.10.2.1 (default gateway/ OPNsense)

Click OK

![19](/assets/img/cyberlab/setup/ad_client/19.png){: width="700" height="400" }

Open command prompt and try pinging the DC, the gateway, and a DNS server

All the pings should work

This VM needs to be able to communicate with the DC in order to join the domain

![20](/assets/img/cyberlab/setup/ad_client/20.png){: width="800" height="400" }

### Joining the Domain

Go to **Settings > Accounts > Access work or school**

Click on connect

![21](/assets/img/cyberlab/setup/ad_client/21.png){: width="600" height="400" }

Click on Join this device to a local Active Directory domain

![22](/assets/img/cyberlab/setup/ad_client/22.png){: width="600" height="400" }

Enter the domain name (cyber.lab)

![23](/assets/img/cyberlab/setup/ad_client/23.png){: width="600" height="400" }

Enter the credentials of a regular user (not the admin)

I am using Bob’s credentials

![24](/assets/img/cyberlab/setup/ad_client/24.png){: width="500" height="300" }

>If you cannot join the domain but can ping the DC, make sure the account is enabled. On the DC VM, head to AD Users and Computers and right click on the user. If you see “Disable Account” as an option, that means the account is enabled.
{: .prompt-info }

![25](/assets/img/cyberlab/setup/ad_client/25.png){: width="600" height="400" }

Set the account type to Standard User

Next

![26](/assets/img/cyberlab/setup/ad_client/26.png){: width="600" height="400" }

Restart now

![27](/assets/img/cyberlab/setup/ad_client/27.png){: width="600" height="400" }

Log in as the user

![28](/assets/img/cyberlab/setup/ad_client/28.png){: width="700" height="400" }

On the DC VM, head to **Tools > AD Users and Computers > Computers**

Notice this new desktop 

You can edit the description and add the full name of the user’s desktop, but I am going to change the name of the client computer

![29](/assets/img/cyberlab/setup/ad_client/29.png){: width="800" height="400" }

On the Windows 10 VM, head to Settings > System > About

Click on Rename this PC

I renamed Bob’s computer to Bob-Workstation

![30](/assets/img/cyberlab/setup/ad_client/30.png){: width="600" height="400" }

I have repeated the same previous steps and created another Windows 10 VM for Alice, with the IP of 10.10.2.11 and the computer name Alice-Workstation

### Connectivity Test

Our DC acts a DNS server and can resolve the computer name to an IP address.

Windows 10/11 hosts block pings by default, but notice that when I ping Bob-Workstation, it says it is pinging 10.10.2.10.

![31](/assets/img/cyberlab/setup/ad_client/31.png){: width="600" height="400" }

From the client VM, we can ping cyber.lab and it tells us that the IP is 10.10.1.10 (the DC).

![32](/assets/img/cyberlab/setup/ad_client/32.png){: width="500" height="400" }

Running ipconfig from Bob’s workstation

![33](/assets/img/cyberlab/setup/ad_client/33.png){: width="700" height="400" }

Running ipconfig from Alice’s workstation

![34](/assets/img/cyberlab/setup/ad_client/34.png){: width="700" height="400" }

On the DC VM, head to AD users and computers

Notice the 2 clients appear (and **Alice-Workstation** is changed to **ALICE-WORKSTATI** because of NetBIOS)

![35](/assets/img/cyberlab/setup/ad_client/35.png){: width="700" height="400" }

We can also ping the clients using their computer/NetBIOS name.

![36](/assets/img/cyberlab/setup/ad_client/36.png){: width="700" height="400" }


### **Next**: [Wazuh Setup](/posts/wazuh)

